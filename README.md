# EvoSplit

Code and data corresponding to "Disentangling Coevolutionary Constraints for Modeling Protein Conformational Heterogeneity". 

## Usage

### To generate MSA:

All MSAs used in this manuscript were generated using the [ColabFold notebook](https://colab.research.google.com/github/sokrypton/ColabFold/blob/main/AlphaFold2.ipynb).

### To cluster MSA and generate subsampled MSA files:

`python run_evosplit.py EX -i input.a3m -o evosplit_results`

Outputs a directory named `evosplit_results` that contains

	| -- unsupervised_cluster
			| -- EX_0.a3m
			| -- EX_1.a3m
			...
	| -- EX.a3m
	| -- msatr_contact.png

`unsupervised_cluster`: MSA clusters identified by KMEANS.
`EX.a3m`: Subfamily MSAs generated after enhanced QID filtering of the input MSAs.
`msatr_contact.png`: Contact predictions generated by the MSA Transformer with EX.a3m as input.

### (Optional) To cluster the MSA using experimentally resolved conformations:
`python run_evosplit.py EX -i input.a3m -o evosplit_results -gt1 gt1.pdb -gt2 gt2.pdb`

The output directory additionally contains

	| -- supervised_cluster
			| -- gt1.a3m
			| -- gt2.a3m
`supervised_cluster`: MSA clusters classified based on match scores with the provided conformations.

### To run AF2:

`python RunAF2.py`

See https://github.com/jproney/AF2Rank for more information on compiling an AlphaFold2 installation.

### To run MSA Transformer:

`python runESM.py -i <my_subMSA.a3m> -o <outdir>`


